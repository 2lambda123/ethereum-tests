# Verify the valid amounts for a withdraw in a single block.
# Specification does not limit the amount of the withdrawal,
# however the amounts should never increase an account's balance over the 256-bit limit.

validAmountsWithdraw:
  genesisBlockHeader:
    bloom: 0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    coinbase: 0x8888f1f195afa192cfee860698584c030f4c9db1
    difficulty: 131072
    extraData: 0x42
    gasLimit: 3141592
    gasUsed: 0
    mixHash: 0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421
    nonce: 0x0102030405060708
    number: 0
    parentHash: 0x0000000000000000000000000000000000000000000000000000000000000000
    receiptTrie: 0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421
    stateRoot: 0xf99eb1626cfa6db435c0836235942d7ccaa935f1ae247d3f1c21e495685f903a
    timestamp: 0x54c98c81
    transactionsTrie: 0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421
    uncleHash: 0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347
#  sealEngine: NoProof

  pre:
    0xa94f5374fce5edbc8e2a8697c15331677e6ebf0b:
      balance: '10000000000'
      nonce: '1'
      code: ''
      storage: {}
    # Withdrawal recipients have code to set storage unconditionally,
    # to verify the EVM is not triggered by the withdrawal.
    0x000000000000000000000000000000000000000a:
      balance: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
      nonce: '0'
      code: |
          :yul {
            sstore(0, 1)
          }
      storage: {}
    0x000000000000000000000000000000000000000b:
      balance: 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe
      nonce: '0'
      code: |
          :yul {
            sstore(0, 1)
          }
      storage: {}
    0x000000000000000000000000000000000000000c:
      balance: 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd
      nonce: '0'
      code: |
          :yul {
            sstore(0, 1)
          }
      storage: {}
    0x000000000000000000000000000000000000000d:
      balance: '0'
      nonce: '0'
      code: |
          :yul {
            sstore(0, 1)
          }
      storage: {}

  blocks:
  - transactions: []
    withdrawals:
    # Spec does not prohibit zero-amount withdrawals, so this is a valid edge-case withdraw to a "full" account
    - index: 0
      address: 0x000000000000000000000000000000000000000a
      amount: '0'
    # Withdraw is valid as long as there is no overflow across one or multiple withdrawals 
    - index: 1
      address: 0x000000000000000000000000000000000000000b
      amount: '1'
    - index: 2
      address: 0x000000000000000000000000000000000000000c
      amount: '1'
    - index: 3
      address: 0x000000000000000000000000000000000000000c
      amount: '1'
    - index: 4
      address: 0x000000000000000000000000000000000000000d
      amount: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff

  expect:
  - network:
    - ">=Shanghai"
    result:
      0x000000000000000000000000000000000000000a:
        balance: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
        nonce: '0'
        storage: {}
      0x000000000000000000000000000000000000000b:
        balance: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
        nonce: '0'
        storage: {}
      0x000000000000000000000000000000000000000c:
        balance: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
        nonce: '0'
        storage: {}
      0x000000000000000000000000000000000000000d:
        balance: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
        nonce: '0'
        storage: {}
