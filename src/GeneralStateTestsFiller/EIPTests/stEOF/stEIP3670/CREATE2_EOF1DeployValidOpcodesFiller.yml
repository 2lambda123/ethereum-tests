# Deploy every Valid Opcode (not including PUSH opcodes)
CREATE2_EOF1DeployValidOpcodes:
  env:
    currentCoinbase: 2adc25665018aa1fe0e6bc666dac8fc2697ff9ba
    currentDifficulty: '0x020000'
    currentGasLimit: '89128960'
    currentBaseFee: '10'
    currentNumber: '1'
    currentTimestamp: '1000'
    previousHash: 5e20a0453cecd065ea59c37ac63e079ee08998b6045136a8ce6635c7912ec0b6

  pre:
    a94f5374fce5edbc8e2a8697c15331677e6ebf0b:
      balance: 1000000000
      code: ''
      nonce: 0
      storage: {}
    b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
      balance: 0
      code: |
        :yul
        {
          // valid opcodes
          mstore(0,  0x000102030405060708090a0b101112131415161718191a1b1c1d203031323334)
          mstore(32, 0x35363738393a3b3c3d3e3f404142434445464748505153545558595a5b808182)
          mstore(64, 0x838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2)
          mstore(96, 0xa3a4f0f1f3f4f5fafdfe00000000000000000000000000000000000000000000)

          // initcode: { mstore(0, 0x0xef00010100130060018080808080808080808080808080808000) return(0, 26)
          mstore(128, 0x7fef000101001300600180808080808080808080808080808080000000000000)
          mstore(160, 0x00600052601a6000f30000000000000000000000000000000000000000000000)
          for { let os := 0 } lt(os, 106) { os := add(os, 1) } 
          { 
            let code := shr(248, mload(os))
            mstore8(154, code) // change returned byte in initcode
            if iszero(create2(0, 128, 41, 0)) { sstore(code, 1) }
          }
          sstore(256, 1)
        }
      nonce: 0
      storage: {}

  transaction:
    data: 
      - ''
    gasLimit:
      - 89000000
    gasPrice: 10
    nonce: 0
    secretKey: 45a915e4d060149eb4365960e6a7a45f334393093061116b197e3240065ff2d8
    to: 'b94f5374fce5edbc8e2a8697c15331677e6ebf0b'
    value:
    - 0

  expect:
    - network:
        - 'Merge+3540+3670+4750'
      result:
       a94f5374fce5edbc8e2a8697c15331677e6ebf0b:
          nonce: 1
       b94f5374fce5edbc8e2a8697c15331677e6ebf0b:
          nonce: 106 # Total created contracts, one contract for each valid opcode
          storage:
            '256': 1
       # Sample of created contracts
       788F29e175F5C83B2E2C06a5cD1bcbb54f31df1B:
          storage: {}
          code: '0xef00010100130060018080808080808080808080808080808000' # STOP
       41996895B9018D8E6A51c3B901eAdA765BbCF1D9:
          storage: {}
          code: '0xef00010100130060018080808080808080808080808080808001' # ADD
       7e4e1674dcE86Ca59b44358e0CebA6c1DA809333:
          storage: {}
          code: '0xef000101001300600180808080808080808080808080808080fe' # INVALID

